<div class="card">
  <div class="card-body">
    <div [hidden]="isLoadingDatas">
      <table
        mat-table
        [dataSource]="dataSource"
        multiTemplateDataRows
        class="mat-elevation-z8"
        matSort
      >
        <ng-container
          matColumnDef="{{ column }}"
          *ngFor="let column of columnsToDisplay"
        >
          <th mat-header-cell *matHeaderCellDef mat-sort-header>
            {{ nameColumnToDisplay(column) | uppercase }}
          </th>
          <input matInput placeholder="Choose a date" />
          <td mat-cell *matCellDef="let element">{{ element[column] }}</td>
        </ng-container>

        <!-- Expanded Content Column - The detail row is made up of this one column that spans across all columns -->
        <ng-container matColumnDef="expandedDetail">
          <td
            mat-cell
            *matCellDef="let element"
            [attr.colspan]="columnsToDisplay.length"
          >
            <div
              class="example-element-detail"
              [@detailExpand]="element.expanded ? 'expanded' : 'collapsed'"
            >
              <table class="detail-table">
                <tr>
                  <th>Item</th>
                  <th>Valor</th>
                  <th>Estoque</th>
                  <th>Validade</th>
                  <th>Status</th>
                </tr>
                <tr *ngFor="let detail of element.details">
                  <td>{{ detail.product }}</td>
                  <td>{{ detail.price }}</td>
                  <td>{{ detail.stock }}</td>
                  <td>{{ detail.validity | date: "d/MM/yyyy" }}</td>
                  <td>{{ detail.ruptura }}</td>
                </tr>
              </table>
            </div>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="columnsToDisplay"></tr>
        <tr
          mat-row
          *matRowDef="let element; columns: columnsToDisplay"
          class="example-element-row"
          [class.example-expanded-row]="element.expanded"
          (click)="toggleRow(element)"
        ></tr>
        <tr
          mat-row
          *matRowDef="let row; columns: ['expandedDetail']"
          class="example-detail-row"
        ></tr>
      </table>

      <mat-paginator
        #paginator [length]="length"
        [pageSize]="pageSize"
        [pageSizeOptions]="pageSizeOptions"
        (page)="pageEvent = $event"
        aria-label="Select page"
      >
      </mat-paginator>
    </div>
  </div>

  <div
    [hidden]="!isLoadingDatas"
    style="
      display: flex;
      justify-content: center;
      align-items: center;
      background: white;
    "
  >
    <mat-progress-spinner color="primary" mode="indeterminate">
    </mat-progress-spinner>
  </div>
</div>
